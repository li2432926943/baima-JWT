import{u as U,q as D,b as l,d as b,r as n,o as p,c as w,e as r,a as o,f as V,w as d,t as k,k as R,i as q,p as I,E as x}from"./index-c67db3df.js";import{a as E}from"./anime-bg-a5ff5050.js";import{_ as L}from"./_plugin-vue_export-helper-c27b6911.js";const M={class:"reset-container"},S={class:"reset-banner"},h={class:"reset-form-container"},j={class:"reset-form-wrapper"},z={key:0,class:"error-tip"},A={key:0,class:"error-tip"},G={__name:"ResetPasswordPage",setup(H){const f=U(),u=D(),C=l(null),_=l(""),v=l("");u.query.email&&(_.value=u.query.email),u.query.code&&(v.value=u.query.code);const t=l(""),a=l(""),s=b({newPassword:"",confirmPassword:""}),B=b({newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度至少为6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:(m,e,i)=>{e!==s.newPassword?i(new Error("两次输入的密码不一致")):i()},trigger:"blur"}]}),N=async()=>{if(t.value="",a.value="",!s.newPassword){t.value="请输入新密码";return}if(s.newPassword.length<6){t.value="密码长度至少为6位";return}if(!s.confirmPassword){a.value="请确认新密码";return}if(s.newPassword!==s.confirmPassword){a.value="两次输入的密码不一致";return}I("/api/auth/reset-password",{email:_.value,code:v.value,password:s.newPassword},()=>{x.success("密码重置成功"),setTimeout(()=>{f.push("/")},2e3)},m=>{x.error(m)})},F=()=>{f.push("/")};return(m,e)=>{const i=n("el-image"),g=n("el-input"),P=n("el-form-item"),y=n("el-button"),T=n("el-form");return p(),w("div",M,[r("div",S,[o(i,{class:"background-image",src:V(E),fit:"cover","preview-teleported":!0,"preview-src-list":[V(E)]},null,8,["src","preview-src-list"]),e[2]||(e[2]=r("div",{class:"welcome-text"},[r("h1",null,"找回密码"),r("p",null,"别担心，我们会帮助您重置密码")],-1))]),r("div",h,[r("div",j,[e[5]||(e[5]=r("h2",{class:"reset-title"},"设置新密码",-1)),e[6]||(e[6]=r("p",{class:"reset-desc"},"验证成功，请设置您的新密码",-1)),o(T,{model:s,class:"reset-form",rules:B,ref_key:"passwordFormRef",ref:C},{default:d(()=>[o(P,{prop:"newPassword",class:"no-error-margin"},{default:d(()=>[o(g,{modelValue:s.newPassword,"onUpdate:modelValue":e[0]||(e[0]=c=>s.newPassword=c),type:"password",placeholder:"请输入新密码"},null,8,["modelValue"]),t.value?(p(),w("div",z,k(t.value),1)):R("",!0)]),_:1}),o(P,{prop:"confirmPassword",class:"no-error-margin"},{default:d(()=>[o(g,{modelValue:s.confirmPassword,"onUpdate:modelValue":e[1]||(e[1]=c=>s.confirmPassword=c),type:"password",placeholder:"请确认新密码"},null,8,["modelValue"]),a.value?(p(),w("div",A,k(a.value),1)):R("",!0)]),_:1}),o(y,{type:"primary",class:"submit-button",onClick:N},{default:d(()=>e[3]||(e[3]=[q("确认重置")])),_:1})]),_:1},8,["model","rules"]),e[7]||(e[7]=r("div",{class:"divider"},[r("span",null,"或者")],-1)),o(y,{class:"back-button",onClick:F},{default:d(()=>e[4]||(e[4]=[q("返回登录")])),_:1})])])])}}},Q=L(G,[["__scopeId","data-v-84a66029"]]);export{Q as default};
